A GW signal from the (quasi-circular) coalescence of two BHs is
completely described in GR by $15$ parameters,
$\bxigr$. These can be grouped into the \emph{intrinsic} parameters:
the (source) masses, $m_1, m_2$ and spins, $\bs1, \bs2$ of the component
objects in the binary; and the
\emph{extrinsic} parameters: a reference time $t_c$ and phase
$\phi_c$, the sky position of the binary ($\alpha$,
$\delta$), the luminosity distance, $d_L$, and the binary's orientation
described through the inclination of the binary $\iota$ and its
polarization $\psi$. We also introduce the total (source) mass $M = m_1+m_2$,
and the (dimensionless) symmetric mass ratio $\nu = m_1m_2/M^2$. When needed, 
we shall denote the detector masses as $m_{1\,\rm det}= (1+z)\,m_1$ and $m_{2 \,\rm det} = (1+z)\,m_2$, 
where $z$ is the redshift. \abhi{We also follow the convention $m_1 > m_2$, and hence the asymmetric mass ratio, $q = m_1/m_2 \geq1$.}

Here, we focus on BHs with spins aligned or anti-aligned
with the orbital angular momentum (henceforth, aligned-spin). In this case,
the GW signal depends on $11$ parameters. We denote the
aligned-spin (dimensionless) components as $\chi_{i} = |\vec{\bm{S}}_i|/m^2_i$, where $i=1,2$ for the two BHs.

\subsection{Parameterized waveform model}\label{sec:model}

As in \paperone, we use an IMR waveform model developed within the effective-one-body (EOB)
formalism~\cite{Buonanno:1998gg,Buonanno:2000ef}. However, whereas \paperone was limited to non-spinning multipolar waveforms,
here we use as our baseline model the aligned-spin multipolar waveform model
developed in Ref.~\cite{Cotesta:2018fcv}. In addition to being
calibrated to NR simulations, this model also uses information from BH
perturbation theory for the merger and ringdown phases. Henceforth we
will denote this model by $\SEOB$ for short~\footnote{In the LIGO Algorithm Library (LAL), this
waveform model is called {\tt SEOBNRv4HM}.}.


In the observer's frame, the GW polarizations can be written as
%
\begin{equation}
h_+(\iota,\varphi_0;t ) - i h_\times(\iota,\varphi_0;t) = \sum_{\ell, m} {}_{-\!2}Y_{\ell m}(\iota,\varphi_0)\, h_{\ell m}(t)\,,
\end{equation}
%
where $\varphi_0$ is the azimuthal direction to the observer (note that without loss of generality we can take $\phi_c\equiv\varphi_0$), while ${}_{-\!2}Y_{\ell m}(\iota,\varphi_0)$ are the $-2$ spin-weighted spherical harmonics. The $\SEOB$ model we employ includes the $(\ell, |m|)=(2,2),(2,1)$, $(3,3)$, $(4,4)$, and $(5,5)$ modes~\cite{Cotesta:2018fcv}. For each $(\ell, m)$, the inspiral-(plunge-)merger-ringdown $\SEOB$ waveform is schematically given by
%
\begin{equation}
h_{\ell m}(t) = h_{\ell m}^\mathrm{insp-plunge}\, \theta(t_\mathrm{match}^{\ell m} - t) + h_{\ell m}^\mathrm{merger-RD}\,\theta(t-t_\mathrm{match}^{\ell m})\,,
\end{equation}
where $\theta(t)$ is the Heaviside step function, $h_{\ell m}^\mathrm{insp-plunge}$ represents the inspiral-plunge part of the waveform, whereas $h_{\ell m}^\mathrm{merger-RD}$ denotes the merger-ringdown waveform, which reads~\citep{Bohe:2016gbl,Cotesta:2018fcv}
%
\begin{equation}
\label{RD}
h_{\ell m}^{\textrm{merger-RD}}(t) = \nu \ \tilde{A}_{\ell m}(t)\ e^{i \tilde{\phi}_{\ell m}(t)} \ e^{-i \sigma_{\ell m 0}(t-t_{\textrm{match}}^{\ell m})},
\end{equation}
%
where $\nu$ is the symmetric mass ratio of the binary and $\sigma_{\ell m0} = 2\pi f_{\ell m 0} -i/\tau_{\ell m 0}$ denotes the complex frequency of the fundamental QNMs of the remnant BH. We denote the oscillation frequencies by $f_{\ell m  0}\equiv \Re(\sigma_{\ell m0})/(2\pi)$ and the decay times by $\tau_{\ell m 0}\equiv -1/\Im(\sigma_{\ell m0}) $.
The functions $\tilde{A}_{\ell m}(t)$ and $\tilde{\phi}_{\ell m}(t)$ are given by~\cite{Bohe:2016gbl,Cotesta:2018fcv}:
%
\begin{subequations}
\begin{eqnarray}
\label{eq:ansatz_amp}
\tilde{A}_{\ell m}(t) &=& c_{1,c}^{\ell m} \tanh[c_{1,f}^{\ell m}\ (t-t_{\textrm{match}}^{\ell m}) \ +\ c_{2,f}^{\ell m}] \ + \ c_{2,c}^{\ell m},\\
\label{eq:ansatz_phase}
\tilde{\phi}_{\ell m}(t) &=& \phi_{\textrm{match}}^{\ell m} - d_{1,c}^{\ell m} \log\left[\frac{1+d_{2,f}^{\ell m} e^{-d_{1,f}^{\ell m}(t-t_{\textrm{match}}^{\ell m})}}{1+d_{2,f}^{\ell m}}\right],
\end{eqnarray}
\end{subequations}
%
where $ \phi_{\textrm{match}}^{\ell m}$ is the phase of the inspiral-plunge mode $(\ell, m)$ computed at $t = t_{\textrm{match}}^{\ell m}$. The coefficients $d_{1,c}^{\ell m}$ and $c_{i,c}^{\ell m}$ with $i = 1,2$
are fixed by imposing that the functions $\tilde{A}_{\ell m}(t)$ and $\tilde{\phi}_{\ell m}(t)$ are of class $C^1$ at $t = t_{\textrm{match}}^{\ell m}$, when matching the merger-ringdown waveform to the inspiral-plunge $\SEOB$ waveform $h_{\ell m}^\mathrm{inspiral-plunge}(t)$. This allows us to write the coefficients $c_{i,c}^{\ell m}$ as~\cite{Cotesta:2018fcv}:
%
\begin{subequations}
\begin{align}
\label{c1}
c_{1,c}^{\ell m} &= \frac{1}{c_{1,f}^{\ell
    m} \nu} \big[ \partial_t|h_{\ell
    m}^{\textrm{insp-plunge}}(t_{\textrm{match}}^{\ell m})| \nonumber \\
    &- \sigma^\textrm{R}_{\ell m} |h_{\ell
    m}^{\textrm{insp-plunge}}(t_{\textrm{match}}^{\ell
    m})|\big] \cosh^2{(c_{2,f}^{\ell m})}, \\
\label{c2}
c_{2,c}^{\ell m} &= -\frac{ |h_{\ell
    m}^{\textrm{insp-plunge}}(t_{\textrm{match}}^{\ell
    m})|}{\nu} + \frac{1}{c_{1,f}^{\ell
    m} \nu} \big[ \partial_t|h_{\ell
    m}^{\textrm{insp-plunge}}(t_{\textrm{match}}^{\ell m})|  \nonumber \\
    &- \sigma^\textrm{R}_{\ell m} |h_{\ell
    m}^{\textrm{insp-plunge}}(t_{\textrm{match}}^{\ell
    m})|\big] \cosh{(c_{2,f}^{\ell m})}\sinh{(c_{2,f}^{\ell m})}, \\ \nonumber
\end{align}
\end{subequations}
and $d_{1,c}^{\ell m}$ as
\begin{align}
\label{d1}
d_{1,c}^{\ell m} &= \left[\omega_{\ell m}^{\textrm{insp-plunge}}(t_{\textrm{match}}^{\ell m}) -  \sigma^\textrm{I}_{\ell
      m}\right]\frac{1+ d_{2,f}^{\ell m}}{d_{1,f}^{\ell m}d_{2,f}^{\ell m}}\,,
\end{align}
%
where we denoted $\sigma_{\ell m}^\textrm{R} \equiv \Im (\sigma_{\ell m0}) < 0$ and  $\sigma_{\ell m}^\textrm{I} \equiv -\Re (\sigma_{\ell m0})$, and $\omega_{\ell m}^{\textrm{insp-plunge}}(t)$ is the frequency of the inspiral-plunge EOB mode. The coefficients $c_{i,f}^{\ell m}$ and $d_{i,f}^{\ell m}$ are obtained through fits to NR and
Teukolsky-equation--based waveforms and can be found in Appendix C of Ref.~\cite{Cotesta:2018fcv}.

In the $\SEOB$ model constructed in Ref.~\cite{Cotesta:2018fcv}, the
complex frequencies $\sigma_{\ell m 0}$ are expressed in terms of the
final BH mass and spin~\cite{Berti:2005ys,Berti:2009kk}, and the
latter are related to the BBH's component masses and spins through
NR--fitting-formulas obtained in
GR~\cite{Taracchini:2013rva,Hofmann:2016yih}. Here instead, in the
spirit of what was done in \paperone, we promote the QNM (complex)
frequencies to be free parameters of the model, while keeping the
inspiral-plunge modes $h_{\ell m}^\mathrm{inspiral-plunge}(t)$ fixed
to their GR values. More explicitly, we introduce a parameterized
version of the $\SEOB$ model where the frequency and the
damping time of the ${\ell m 0}$ mode (i.e, $(f_{\ell m 0}, \tau
_{\ell m 0})$) are defined through the fractional deviations, $(\delta
f_{\ell m 0},\delta \tau_{\ell m 0})$, from the corresponding GR
values~\cite{Gossan:2011ha,Meidam:2014jpa}.


Thus,
\begin{subequations}
\begin{eqnarray}
f_{\ell m 0} &=& f_{\ell m 0}^{\text{GR}}\, (1 + \delta f_{\ell m 0})\,,\label{eq:nongr_freqs_a} \\ 
\tau _{\ell m 0} &=& \tau _{\ell m 0}^{\text{GR}}\, (1 + \delta \tau_{\ell m 0})\,. \label{eq:nongr_freqs_b}
\end{eqnarray}
\end{subequations}

\comment{AB: as discussed, please expalin very clearly how the GR frequency and decay times are computed, and mark in the equation above 
their dependence on the mass and spin parameters.}\abhi{The GR quantities $( f_{\ell m 0}^{GR},\tau_{\ell m 0}^{GR})$ are
constructed using the NR--fitting--formula from Refs.~\cite{Taracchini:2013rva,Hofmann:2016yih}, and are functions of the initial masses and spins, $(m_1, m_2, \chi_1, \chi_2)$. For every single instance of waveform generation, we choose a value for $(m_1, m_2, \chi_1, \chi_2, \delta f_{\ell m 0}, \delta \tau_{\ell m 0})$. While the mass and spin value go into the construction of $( f_{\ell m 0}^{\text{GR}}, \tau _{\ell m 0}^{\text{GR}})$, these GR quantities and then combined with the values of $(\delta f_{\ell m 0}, \delta \tau_{\ell m 0})$ as shown in the Eqs.~\ref{eq:nongr_freqs_a}-~\ref{eq:nongr_freqs_b}.. Hence,
\begin{subequations}
\begin{eqnarray}
f_{\ell m 0} &=& f_{\ell m 0}(m_1, m_2, \chi_1, \chi_2, \delta f_{\ell m 0}, \delta \tau_{\ell m 0})\\ 
\tau _{\ell m 0} &=& \tau _{\ell m 0}(m_1, m_2, \chi_1, \chi_2, \delta f_{\ell m 0}, \delta \tau_{\ell m 0})
\end{eqnarray}
\end{subequations}
We denote such a parameterized waveform model $\pSEOB$~\footnote{This
waveform model is called {\tt pSEOBNRv4HM} in LAL.}.} We note that when leaving $\sigma_{\ell m}$ to vary
freely, the functions $\tilde{A}_{\ell m}(t)$ and $\tilde{\phi}_{\ell
  m}(t)$ in general also differ from the GR predictions, since
those functions depend on the QNM complex frequencies, as can be seen
from the expressions for $c_{i,c}^{\ell m}$ and $d_{1,c}^{\ell m}$ in Eqs.~(\ref{c1}),
(\ref{c2}), and (\ref{d1}). As a consequence, the ringdown signal (amplitude and phase) 
soon after merger deviates from the one predicted by GR.


\subsection{Bayesian parameter-estimation technique}
\label{sec:method}

The parameterized model, $\pSEOB$, described above introduces an additional set of non-GR parameters, $\bxingr = (\delta f_{\ell m 0},\delta \tau_{\ell m 0})$, corresponding to each $(\ell,m)$ QNM present in the GR waveform model $\SEOB$. One then proceeds to use the Bayes theorem to obtain the \emph{posterior} probability distribution on $\blambda = \{\bxigr, \bxingr\}$, given a hypothesis $\mathcal{H}$:
%
\begin{equation}
P(\blambda | d, \mathcal{H}) = \frac{P(\blambda | \mathcal{H}) \, \mathcal{L}(d | \blambda, \mathcal{H})}{P(d|\mathcal{H})},
\label{eq:Bayes_theorem}
\end{equation}
%
where $P(\blambda | \mathcal{H})$ is the \emph{prior} probability distribution, and $\mathcal{L}(d | \blambda, \mathcal{H})$ is called the \emph{likelihood} function. The denominator is a normalization constant $P(d|\mathcal{H}) = \int P(\blambda | \mathcal{H}) \, \mathcal{L}(d | \blambda, \mathcal{H}) \, d\blambda$, called the marginal likelihood, or the \emph{evidence} of the hypothesis $\mathcal{H}$. In this case, our hypothesis $\mathcal{H}$ is that the data contains a GW signal that is described by the $\pSEOB$ waveform model $h(\blambda)$  and stationary Gaussian noise described by a power spectral density (PSD) $S_n(f)$. The likelihood function can consequently be defined as:
%
\begin{equation}
\mathcal{L}(d | \blambda, \mathcal{H}) \propto \exp\big[-\frac{1}{2} \langle d - h(\blambda) \, | \, d -h(\blambda) \rangle \big],
\label{eq:likelihood}
\end{equation}
%
where $\langle . | . \rangle$ is the usual noise-weighted inner product:
%
\begin{equation}
\langle A | B \rangle = \int_{f_\mathrm{low}} ^{f_\mathrm{high}} df \frac{\tilde{A}^*(f)\tilde{B}(f) + \tilde{A}(f)\tilde{B}^*(f)}{S_n(f)}.
\label{eq:nwip}
\end{equation}
%
The quantity $\tilde{A}(f)$ denotes the Fourier transform of $A(t)$ and the $^*$ indicates complex conjugation. The limits of integration ${f_\mathrm{low}}$ and ${f_\mathrm{high}}$ define the bandwidth of the sensitivity of the GW detector. We usually assume ${f_\mathrm{high}}$ to be the Nyquist frequency whereas ${f_\mathrm{low}}$ is dictated by the performance of the
GW detector at low-frequency. Here, we follow the choice made in the LIGO-Virgo analysis~\cite{LIGOScientific:2018mvr,Abbott:2020niy}. Owing to the large dimensionality of the parameter set $\blambda$, the posterior distribution $P(\blambda | d, \mathcal{H})$ in Eq.~(\ref{eq:Bayes_theorem}) is computed by stochastically sampling the parameter space using techniques such as Markov-chain Monte Carlo (MCMC)~\cite{Metropolis:1953am,Hastings:1970aa} or Nested Sampling~\cite{Skilling:2006gxv}. For this paper, we use the \verb+LALInference+~\cite{Veitch:2014wba} and \verb+Bilby+ codes~\cite{Ashton:2018jfp,Smith:2019ucc} that provide an implementation of the parallely tempered MCMC and Nested Sampling algorithms respectively, for computing the posterior distributions.

Given the full-dimensional posterior probability density function $P(\blambda | d, \mathcal{H})$, we can marginalize over the \emph{nuisance} parameters, to obtain the marginalized posterior probability density function over the QNM parameters $\bxingr$:

\begin{equation}
P(\bxingr | d, \mathcal{H})= \int P(\blambda | d, \mathcal{H}) d\bxigr\,.
\end{equation}

For most of the results discussed in this paper, we restrict ourselves
to the $(\ell m) = (2,2)$ and/or $(3,3)$ modes. In those cases we assume $\bxingr = \{\df{220},\dtau{220}\}$ and/or $
\{\df{330},\dtau{330}\}$, and \ab{fix} all the other $(\ell m)$ modes to \sout{be
fixed at} their GR predictions (i.e., $\delta f_{\ell m 0} = \delta
\tau_{\ell m 0} = 0$). This is because, for most of the high-mass BH
events that we find most appropriate for this test, the LIGO-Virgo
observations are consistent with nearly--equal-mass face-on/off BBHs
for which power in the subdominant modes is not enough to
attempt to measure more than one QNM complex frequency.

Lastly, throughout our analysis, we assume uniform priors on our non-GR QNM
parameters, $(\delta f_{\ell m 0},\delta \tau_{\ell m 0})$. We note that
since the priors on $( f_{\ell m 0}^{GR},\tau_{\ell m 0}^{GR})$ are
derived through NR--fits, from the corresponding priors on the initial
masses and spins, this leads to a non-trivial prior on the final
reconstructed frequency and damping time, $( f_{\ell m 0},\tau_{\ell m
  0})$. Also, given the definition of the damping time in
Sec.~\ref{sec:model}, we note that $\delta \tau_{\ell m 0} = -1$ leads
to the imaginary part of the QNM complex frequency going to infinity. We avoid
this by restricting the minimum of the prior on $\delta \tau_{\ell m
  0}$ to be greater than $-1$.

\iffalse
\subsection{Priors}

Throughout our analysis we assume a completely prior uniform in the component masses $m_1, m_2$. Our prior on the spins are uniform in the magnitude between (0,1) and isotropic in spin orientation, but finally restricted to the component parallel to the orbital angular momentum of the binary. The prior on the distance varies as $d_L^2$ giving more weightage to binaries farther out. For the rest of the parameters we use standard priors as defined in the documentation (CITE Vietch et al. 2015 LALInference paper). For our non-GR ringdown parameters, we assume uniform priors. This of course leads to a non-trivial prior on the reconstructed frequency and damping time, because of the prior on $( f_{\ell m 0}^{GR},\tau_{\ell m 0}^{GR})$, which itself depend on the prior on the initial masses and spins through NR fits \abhi{perhaps figure on priors on QNM quantities}. For $d\tau = -1$, we encounter a singularity (the imaginary part of the frequency goes to infinity), which we avoid by restricting the minimum of the prior on $d\tau$ to be greater than $-1$.
\fi
